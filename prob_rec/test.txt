系统管理/岗位权限维护：
   进口货运。下面，委托查询。选中了。点保存生成不了sql语句。就是不提交json的insert操作。 20140415




一 委托维护
  1.查询：弹出查询窗口，输入提单号返回模糊查询的委托列表，选择委托后，查询窗口关闭，
         根据选择的提单号，刷新委托表单、委托动态表格、委托箱量表格。                     ---     ok
  2.增加：清空委托、委托动态、委托箱量                                                    ---   ok
  3.删除：删除当前委托，数据库级联删除委托动态、委托箱量                              -- ok
  4.保存：将委托、委托动态、委托箱量打包保存                                         -- ok
  5.锁定：委托锁定,contract.finish_flag = true,contract.finish_time = '指定时间'    -- ok
  6.解锁：委托解锁,contract.finish_flag = null,contract.finish_time = null       -- error :  see below
  7.增加动态：contract_action增加记录                                                       ok
  8.删除动态：contract_action删除记录                                                        ok
  9.增加箱量：contract_cntr增加记录                                                            ok
  10.删除箱量：contract_cntr删除记录                                                             ok

  --------  有时候会出现 js 错误。怀疑是网页刷新代码不全导致的错误。

二 委托应收付维护（pre_fee）
  1.查询：弹出查询窗口，输入提单号返回模糊查询的委托列表，选择委托后，查询窗口关闭，
         根据选择的提单号，刷新委托表单、应收费用、应付费用。                            -- ok
  2.保存：保存应收付费用                                                               -- ok
  3.费用锁定：锁定选择的应收付费用，pre_fee.lock_flag = true                        -- ok
  4.费用解锁：解锁选择的应收付费用，pre_fee.lock_flag = null.已核销的禁止执行。     -- ok




--------------
03-31 21:52:49 -> dealPAjax -> {'rows': [{'id': 4, 'table': 'contract', 'subs': {}, 'cols': {'finish_flag': [''], 'finish_time': ['']}, 'op': 'update'}], 'func': '委托解锁', 'reqtype': 'updatedirty'}
委托解锁。功能写反了。 op：是updatedirty。。。。reqtype：是update        --ok

三 核销
  1.查询：查询条件 客户+费用类型(收/付)，根据此组合条件，查询未核销的act_fee和pre_fee，缺少任一条件，核销按钮禁用。
  2.选择费用：选择要进行核销的act_fee和pre_fee,如果选择的act_fee数组或pre_fee数组为空，禁止核销。
  3.核销：act_fee的拆分条件为 client_id + fee_typ + pay_typ
         pre_fee的拆分条件为 client_id + fee_typ + contract_id + fee_cod
    测试数据:
    a. act_fee: 现金 1000
                现金 500
       pre_fee: 提单号：A  包干费：300
       结果：act_fee从1000或500两个任意选一条核销，增加一条act_fee,现金700或200,
            pre_fee 提单号：A  包干费：300已核销 未生成新记录
    b. act_fee: 现金 1000
                现金 500
       pre_fee: 提单号：B  包干费：800
       结果：act_fee 1000核销完毕，增加一条act_fee现金200,原有现金500不变
            pre_fee 提单号：B  包干费：800已核销 未生成新记录
    c. act_fee: 支票 1000
                现金 500
       pre_fee: 提单号：C  包干费：300
       结果：act_fee从支票1000或现金500两个任意选一条核销，增加一条act_fee现金200或支票700,未核销的保持不变
            pre_fee 提单号：C  包干费：300已核销 未生成新记录
    d. act_fee: 支票 1000
                现金 500
       pre_fee: 提单号：D  包干费：800
       结果：act_fee 支票1000核销完毕，增加一条act_fee支票200,原有现金500不变
            pre_fee 提单号：D  包干费：800已核销 未生成新记录
    e. act_fee: 支票 1000
                现金 500
       pre_fee: 提单号：E  包干费：800  堆存费：1000
       结果：

